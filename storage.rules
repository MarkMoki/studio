rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // User profile pictures: users/{userId}/profile.{jpg|png|jpeg}
    match /users/{userId}/profile.{extension} where extension in ['jpg', 'png', 'jpeg'] {
      allow read: if true; // Publicly readable
      allow write: if request.auth != null && request.auth.uid == userId && request.resource.size < 2 * 1024 * 1024; // Max 2MB
    }

    // Creator cover images: creators/{creatorId}/cover.{jpg|png|jpeg}
    // Assuming creatorId is the same as userId
    match /creators/{creatorId}/cover.{extension} where extension in ['jpg', 'png', 'jpeg'] {
      allow read: if true; // Publicly readable
      allow write: if request.auth != null && request.auth.uid == creatorId && request.resource.size < 5 * 1024 * 1024; // Max 5MB
    }
    
    // Deny all other writes by default
    // match /{allPaths=**} {
    //   allow read, write: if false; 
    // }
    // Be careful with default deny, ensure your paths are covered or add specific rules.
  }
}
